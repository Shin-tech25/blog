{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/python-flake8/","result":{"data":{"site":{"siteMetadata":{"title":"Developer's blog"}},"markdownRemark":{"id":"bc764bde-12fe-519b-9b92-d7b443600437","excerpt":"Flake8 の概要 Flake8 は Python コードのスタイルガイドやプログラミングのベストプラクティスに基づいて、コードを自動的にチェックするためのツールです。具体的には、Python コードの PEP 8（Python…","tableOfContents":"<ul>\n<li><a href=\"#flake8-%E3%81%AE%E6%A6%82%E8%A6%81\">Flake8 の概要</a></li>\n<li><a href=\"#%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%82%88%E3%82%8A%E4%BE%BF%E5%88%A9%E3%81%AA-flake8-%E3%81%AE%E5%88%A9%E7%94%A8\">プラグインを利用したより便利な Flake8 の利用</a></li>\n<li><a href=\"#micorosoft-vscode-%E3%81%A7%E3%81%AE-flake8-%E3%81%AE%E5%88%A9%E7%94%A8\">Micorosoft VSCode での Flake8 の利用</a></li>\n</ul>","html":"<h2 id=\"flake8-の概要\" style=\"position:relative;\"><a href=\"#flake8-%E3%81%AE%E6%A6%82%E8%A6%81\" aria-label=\"flake8 の概要 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Flake8 の概要</h2>\n<p>Flake8 は Python コードのスタイルガイドやプログラミングのベストプラクティスに基づいて、コードを自動的にチェックするためのツールです。具体的には、Python コードの PEP 8（Python のスタイルガイド）準拠をチェックし、コードの品質を高めるための静的解析を行います。</p>\n<p>PEP 8 の考え方に、「コードは書かれるよりも読まれることのほうがはるかに多い」というものがあります。読みにくいコードは、複雑さや難しさの観点ももちろんありますが、コードの改行位置や空白の数、命名規則など、些細なところが気になり読みにくいことがよくあります。コーディング規約である PEP 8 を守ることでこの点を解決でき、さらにチェックをツールに任せることにより、人がチェックする労力を削減できることも Flake8 の大きな利点となります。</p>\n<p>Flake8 を実行すると、これら 3 つのツールの観点でソースコードに対しチェックを行います。</p>\n<ul>\n<li>pycodestyle: PEP 8 に準拠しているかどうかをチェックします。</li>\n<li>Pyflakes: 未使用の変数やインポート、不正なコード構造などを検出します。これにより、エラーやバグの発見に役立ちます。</li>\n<li>McCabe: 関数の複雑度（サイクロマティック複雑度）を計測します。これにより、コードがあまりにも複雑でないかをチェックできます。</li>\n</ul>\n<p>Flake8 で表示されるエラーコードの先頭一文字目は、エラーを検出したツールの種類（pycodestyle, Pyflakes, McCabe）を表しています。</p>\n<table>\n<thead>\n<tr>\n<th>エラーコード</th>\n<th>ツール</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>E/W</td>\n<td>pycodestyle によるエラー</td>\n</tr>\n<tr>\n<td>F</td>\n<td>Pyflakes によるエラー</td>\n</tr>\n<tr>\n<td>C</td>\n<td>McCabe によるエラー</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"プラグインを利用したより便利な-flake8-の利用\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%82%88%E3%82%8A%E4%BE%BF%E5%88%A9%E3%81%AA-flake8-%E3%81%AE%E5%88%A9%E7%94%A8\" aria-label=\"プラグインを利用したより便利な flake8 の利用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プラグインを利用したより便利な Flake8 の利用</h2>\n<p>Flake8 にはチェック機能を強化するプラグインがあります。プラグインを利用することで、より多くの観点での静的解析が可能です。以下に、プラグインの一部を紹介します。</p>\n<table>\n<thead>\n<tr>\n<th>プラグイン名</th>\n<th>概要</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>flake8-import-order</td>\n<td>import の順序をチェックする</td>\n</tr>\n<tr>\n<td>pep8-naming</td>\n<td>PEP 8 の命名規約に準拠しているかをチェックする</td>\n</tr>\n<tr>\n<td>flake8-commas</td>\n<td>カンマの位置をチェックする</td>\n</tr>\n<tr>\n<td>flake8-quotes</td>\n<td>クォートをチェックする</td>\n</tr>\n<tr>\n<td>flake8-docstrings</td>\n<td>docstring の有無や書き方をチェックする</td>\n</tr>\n<tr>\n<td>flake8-print</td>\n<td>print 関数の不要な使用をチェックする</td>\n</tr>\n</tbody>\n</table>\n<p>Flake8 のプラグインの使い方は非常に簡単です。pip コマンドでプラグインをインストールし、flake8 コマンドを実行するだけで、そのプラグインツールでのチェックを行うことができます。</p>\n<h2 id=\"micorosoft-vscode-での-flake8-の利用\" style=\"position:relative;\"><a href=\"#micorosoft-vscode-%E3%81%A7%E3%81%AE-flake8-%E3%81%AE%E5%88%A9%E7%94%A8\" aria-label=\"micorosoft vscode での flake8 の利用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Micorosoft VSCode での Flake8 の利用</h2>\n<p>Flake8 によるチェックのタイミングを人間の判断に任せていると、チェックを忘れてしまうことがよくあります。Flake8 も Black や mypy と同様に自動でチェックする仕組みを作るのがおすすめです。自動でチェックする方法はいくつかありますが、エディターでのチェックと、CI（継続的インテグレーション）でのチェックを併用して運用すると良いと思います。</p>\n<p>Microsoft VSCode においては、<code class=\"language-text\">python.linting.flake8Enabled</code>という設定を有効化すると Flake8 をエディターに統合して利用することができます。</p>\n<p>まずは、Flake8 およびプラグインツールをインストールするための Python 仮想環境を作成します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> ~/.venv\npython3 <span class=\"token parameter variable\">-m</span> venv ~/.venv/linting\n<span class=\"token builtin class-name\">source</span> ~/.venv/linting/bin/activate\n\n<span class=\"token punctuation\">(</span>linting<span class=\"token punctuation\">)</span> pip <span class=\"token function\">install</span> <span class=\"token parameter variable\">-U</span> pip\n<span class=\"token punctuation\">(</span>linting<span class=\"token punctuation\">)</span> pip <span class=\"token function\">install</span> flake8 flake8-import-order pep8-naming flake8-commas flake8-quotes flake8-docstrings flake8-print</code></pre></div>\n<p>次に、VSCode の<code class=\"language-text\">settings.json</code>をプロジェクトルートディレクトリ配下の<code class=\"language-text\">.vscode/</code>ディレクトリにに配置して、以下のように記述します。</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"python.linting.enabled\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"python.linting.flake8Enabled\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"python.linting.flake8Path\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"~/.venv/linting/bin/flake8\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Python 拡張機能がまだ VSCode にインストールされていない場合は、インストールを行います。<code class=\"language-text\">Ctrl + Shift +X</code>から拡張機能を開き、Python と入力してインストールを行います。</p>\n<p>次に、作成した Python 仮想環境の Python インタープリターを選択します。<code class=\"language-text\">Ctrl + Shift + P</code>からコマンドパレットを開き「Python: Select Interpreter」と入力し、Python: Select Interpreter を選択します。適切な Python インタープリタ（仮想環境など）を選択します。</p>\n<p>VSCode 右下にある Python インタープリターの表示が以下のようになっていれば良いです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 208px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3292ddf80235f5d87e657ae35e0535f2/8f2fb/vscode.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.0126582278481%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABYklEQVR42m1Oy07CUBTsDygW0fC00NIAxVIgEh4VpECpVB6FKJr4YisaEyNRNJoQXyFE48atKz90vFxcqYvJzJxz7txhAu55BNy2X/hvZgPvmbHf9feO9yxQMILPgaBvmRgHObRT8J4lcrQIPwHnYqkO/Ow5J0vnUy3QdywNnoYJXpYEeh2QghzUNQVmpQi9qKJW2UDLNLCla0QX0WnUYGh5mMS365uoG2VUCjlIwgr5yE4bTsM45zwYv5uFyLkQC/NQwgLkUAAy0bGIgLgkYj2dQFIOQSE+nYwik5TpXIkEZ+1JQ79rjiImOsHo6irK2SgKKRE7TQ27VgXdVgl7lo7thoaOWUDLUNGsZgnnqC+rMrSMhKOuiZzCQUuH0CE7PSOCuT7v4eTYQr0Yw2h4ireXW8JnmDwOMR4N8D6+w/P9BS77B3h9usHk4Qr7bQ29bhVfnx9olBKw9BQG/UPk4xy+AZCkwUaEKAVNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vscode.png\"\n        title=\"\"\n        src=\"/static/3292ddf80235f5d87e657ae35e0535f2/8f2fb/vscode.png\"\n        srcset=\"/static/3292ddf80235f5d87e657ae35e0535f2/c26ae/vscode.png 158w,\n/static/3292ddf80235f5d87e657ae35e0535f2/8f2fb/vscode.png 208w\"\n        sizes=\"(max-width: 208px) 100vw, 208px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"Flake8によるPythonの静的解析、リファクタリング","date":"2024-10-09","description":"Flake8はPythonコードのスタイルガイドやプログラミングのベストプラクティスに基づいて、コードを自動的にチェックするためのツールです。具体的には、PythonコードのPEP 8（Pythonのスタイルガイド）準拠をチェックし、コードの品質を高めるための静的解析を行います。","tags":["Python","外部ライブラリ","静的解析"],"featuredImage":{"publicURL":"/static/58806ff8f67ddf870a8d9902f47dcd61/python2.jpg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/58806ff8f67ddf870a8d9902f47dcd61/3c367/python2.jpg","srcSet":"/static/58806ff8f67ddf870a8d9902f47dcd61/19e71/python2.jpg 128w,\n/static/58806ff8f67ddf870a8d9902f47dcd61/68974/python2.jpg 256w,\n/static/58806ff8f67ddf870a8d9902f47dcd61/3c367/python2.jpg 512w","sizes":"(min-width: 512px) 512px, 100vw"},"sources":[{"srcSet":"/static/58806ff8f67ddf870a8d9902f47dcd61/6766a/python2.webp 128w,\n/static/58806ff8f67ddf870a8d9902f47dcd61/22bfc/python2.webp 256w,\n/static/58806ff8f67ddf870a8d9902f47dcd61/d689f/python2.webp 512w","type":"image/webp","sizes":"(min-width: 512px) 512px, 100vw"}]},"width":512,"height":512}}}}},"relatedPosts":{"nodes":[]},"previous":{"fields":{"slug":"/shebang-python-script/"},"frontmatter":{"title":"シェルスクリプトからPythonを用いるためのシバン（Shebang）"}},"next":{"fields":{"slug":"/dnf-error-check/"},"frontmatter":{"title":"RHEL系OSでリポジトリ構成のエラーを検証する方法"}}},"pageContext":{"id":"bc764bde-12fe-519b-9b92-d7b443600437","previousPostId":"39735bb9-eb5e-527e-aeb8-4a9d25ef701a","nextPostId":"6cbd55dc-f3f3-57e2-b204-fe770644b1b2","relatedPosts":[]}},"staticQueryHashes":["2841359383"],"slicesMap":{}}