{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/python-timeit/","result":{"data":{"site":{"siteMetadata":{"title":"Developer's blog"}},"markdownRemark":{"id":"b2e2e472-1dab-5538-9922-d0e80d1969a7","excerpt":"Python…","tableOfContents":"<ul>\n<li>\n<p><a href=\"#1-code-classlanguage-texttimeitcode-%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%AE%E6%A6%82%E8%A6%81\">1. <code class=\"language-text\">timeit</code> モジュールの概要</a></p>\n</li>\n<li>\n<p><a href=\"#2-code-classlanguage-texttimeitcode-%E3%81%AE%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E4%BD%BF%E3%81%84%E6%96%B9\">2. <code class=\"language-text\">timeit</code> の基本的な使い方</a></p>\n<ul>\n<li>\n<p><a href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9%E3%81%A7%E3%81%AE%E4%BD%BF%E7%94%A8\">コマンドラインインターフェースでの使用</a></p>\n<ul>\n<li><a href=\"#%E4%B8%BB%E3%81%AA%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3\">主なオプション</a></li>\n<li><a href=\"#%E4%BD%BF%E7%94%A8%E4%BE%8B\">使用例</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E5%86%85%E3%81%A7%E3%81%AE%E4%BD%BF%E7%94%A8\">スクリプト内での使用</a></p>\n<ul>\n<li><a href=\"#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E4%BD%BF%E7%94%A8%E4%BE%8B\">基本的な使用例</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-timer-%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E8%A8%88%E6%B8%AC\">3. Timer クラスを使用した計測</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%E4%BD%BF%E7%94%A8%E4%BE%8B-1\">使用例</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E8%A4%87%E6%95%B0%E8%A1%8C%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A8%88%E6%B8%AC\">複数行コードの計測</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#4-%E3%82%88%E3%81%8F%E3%81%82%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%A8%E5%AF%BE%E5%87%A6%E6%B3%95\">4. よくあるエラーと対処法</a></p>\n<ul>\n<li>\n<p><a href=\"#nameerror-%E3%81%AE%E5%AF%BE%E5%87%A6\">NameError の対処</a></p>\n<ul>\n<li><a href=\"#%E3%82%A8%E3%83%A9%E3%83%BC%E4%BE%8B\">エラー例</a></li>\n<li><a href=\"#%E4%BF%AE%E6%AD%A3%E7%89%88\">修正版</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#5-%E3%82%AC%E3%83%99%E3%83%BC%E3%82%B8%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A8-code-classlanguage-texttimeitcode\">5. ガベージコレクションと <code class=\"language-text\">timeit</code></a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%E3%82%AC%E3%83%99%E3%83%BC%E3%82%B8%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96\">ガベージコレクションを有効化</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#6-%E5%AE%9F%E7%94%A8%E4%BE%8B%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E6%9C%80%E9%81%A9%E5%8C%96\">6. 実用例：コードの最適化</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%E3%83%AA%E3%82%B9%E3%83%88%E5%86%85%E5%8C%85%E8%A1%A8%E8%A8%98-vs-for-%E3%83%AB%E3%83%BC%E3%83%97\">リスト内包表記 vs. for ループ</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E7%B5%90%E8%AB%96\">結論</a></p>\n</li>\n</ul>","html":"<p>Python でプログラムのパフォーマンスを向上させるためには、コードの実行時間を計測し、ボトルネックを見つけることが重要です。<code class=\"language-text\">timeit</code> モジュールは、この目的のために設計された標準ライブラリで、簡単かつ正確にコードの実行時間を測定することができます。本記事では、<code class=\"language-text\">timeit</code> モジュールの使用方法や、実用的な活用例について詳しく解説します。</p>\n<h2 id=\"1-code-classlanguage-texttimeitcode-モジュールの概要\" style=\"position:relative;\"><a href=\"#1-code-classlanguage-texttimeitcode-%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%AE%E6%A6%82%E8%A6%81\" aria-label=\"1 code classlanguage texttimeitcode モジュールの概要 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. <code class=\"language-text\">timeit</code> モジュールの概要</h2>\n<p><code class=\"language-text\">timeit</code> は、Python コードの実行時間を高精度で計測するためのモジュールです。特に、以下の特徴があります：</p>\n<ul>\n<li><strong>簡単にコードのパフォーマンスを測定</strong>：わずかなコードで実行時間を計測可能。</li>\n<li><strong>ノイズを排除</strong>：計測中にガベージコレクションを一時停止することで、より正確な時間を測定。</li>\n<li><strong>柔軟な使用方法</strong>：コマンドラインインターフェース（CLI）とスクリプト実行の両方をサポート。</li>\n</ul>\n<h2 id=\"2-code-classlanguage-texttimeitcode-の基本的な使い方\" style=\"position:relative;\"><a href=\"#2-code-classlanguage-texttimeitcode-%E3%81%AE%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E4%BD%BF%E3%81%84%E6%96%B9\" aria-label=\"2 code classlanguage texttimeitcode の基本的な使い方 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. <code class=\"language-text\">timeit</code> の基本的な使い方</h2>\n<h3 id=\"コマンドラインインターフェースでの使用\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9%E3%81%A7%E3%81%AE%E4%BD%BF%E7%94%A8\" aria-label=\"コマンドラインインターフェースでの使用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コマンドラインインターフェースでの使用</h3>\n<p>コマンドラインから <code class=\"language-text\">timeit</code> を実行する場合、シンプルなワンライナーや短いコードを計測するのに適しています。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">python <span class=\"token parameter variable\">-m</span> timeit <span class=\"token punctuation\">[</span>-n N<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-r N<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-s S<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>statement<span class=\"token punctuation\">]</span></code></pre></div>\n<h4 id=\"主なオプション\" style=\"position:relative;\"><a href=\"#%E4%B8%BB%E3%81%AA%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3\" aria-label=\"主なオプション permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>主なオプション</h4>\n<ul>\n<li><code class=\"language-text\">-n N</code>：コードを実行する回数を指定します。</li>\n<li><code class=\"language-text\">-r N</code>：計測を繰り返す回数（デフォルトは 5 回）。</li>\n<li><code class=\"language-text\">-s S</code>：実行前に 1 度だけ実行されるセットアップコード。</li>\n</ul>\n<h4 id=\"使用例\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8%E4%BE%8B\" aria-label=\"使用例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用例</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ python <span class=\"token parameter variable\">-m</span> timeit <span class=\"token parameter variable\">-s</span> <span class=\"token string\">'text = \"hello world\"'</span> <span class=\"token string\">'\"world\" in text'</span>\n<span class=\"token number\">10000000</span> loops, best of <span class=\"token number\">5</span>: <span class=\"token number\">0.045</span> sec per loop</code></pre></div>\n<p>一方、スクリプト内で <code class=\"language-text\">timeit</code> を使用する場合は、より柔軟な計測が可能です。</p>\n<h3 id=\"スクリプト内での使用\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E5%86%85%E3%81%A7%E3%81%AE%E4%BD%BF%E7%94%A8\" aria-label=\"スクリプト内での使用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スクリプト内での使用</h3>\n<p>スクリプト内で <code class=\"language-text\">timeit</code> を使用する場合は、以下の関数が利用可能です：</p>\n<ul>\n<li><strong><code class=\"language-text\">timeit.timeit</code></strong>：指定したコードを一定回数実行し、実行時間を計測。</li>\n<li><strong><code class=\"language-text\">timeit.repeat</code></strong>：計測を複数回繰り返し、リスト形式で結果を返します。</li>\n</ul>\n<h4 id=\"基本的な使用例\" style=\"position:relative;\"><a href=\"#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E4%BD%BF%E7%94%A8%E4%BE%8B\" aria-label=\"基本的な使用例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>基本的な使用例</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> timeit\n\n<span class=\"token comment\"># 単純なコードの実行時間を計測</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>timeit<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token string\">'\"-\".join(str(n) for n in range(100))'</span><span class=\"token punctuation\">,</span> number<span class=\"token operator\">=</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 繰り返し回数を指定して複数回計測</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>timeit<span class=\"token punctuation\">.</span>repeat<span class=\"token punctuation\">(</span><span class=\"token string\">'\"-\".join(str(n) for n in range(100))'</span><span class=\"token punctuation\">,</span> number<span class=\"token operator\">=</span><span class=\"token number\">10000</span><span class=\"token punctuation\">,</span> repeat<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"3-timer-クラスを使用した計測\" style=\"position:relative;\"><a href=\"#3-timer-%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E8%A8%88%E6%B8%AC\" aria-label=\"3 timer クラスを使用した計測 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Timer クラスを使用した計測</h2>\n<p><code class=\"language-text\">Timer</code> クラスを使用すると、セットアップコードを柔軟に指定できます。</p>\n<h4 id=\"使用例-1\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8%E4%BE%8B-1\" aria-label=\"使用例 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用例</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> timeit <span class=\"token keyword\">import</span> Timer\n\nsetup_code <span class=\"token operator\">=</span> <span class=\"token string\">'numbers = list(range(1000))'</span>\ntest_code <span class=\"token operator\">=</span> <span class=\"token string\">'sum(numbers)'</span>\n\nt <span class=\"token operator\">=</span> Timer<span class=\"token punctuation\">(</span>stmt<span class=\"token operator\">=</span>test_code<span class=\"token punctuation\">,</span> setup<span class=\"token operator\">=</span>setup_code<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span>number<span class=\"token operator\">=</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ここでは、リストの合計を計算するコードの実行時間を測定しています。</p>\n<h3 id=\"複数行コードの計測\" style=\"position:relative;\"><a href=\"#%E8%A4%87%E6%95%B0%E8%A1%8C%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A8%88%E6%B8%AC\" aria-label=\"複数行コードの計測 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>複数行コードの計測</h3>\n<p>複数行にわたるコードも <code class=\"language-text\">timeit</code> で計測できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">code <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">'''\nfor i in range(100):\n    x = i ** 2\n'''</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>timeit<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span>stmt<span class=\"token operator\">=</span>code<span class=\"token punctuation\">,</span> number<span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"4-よくあるエラーと対処法\" style=\"position:relative;\"><a href=\"#4-%E3%82%88%E3%81%8F%E3%81%82%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%A8%E5%AF%BE%E5%87%A6%E6%B3%95\" aria-label=\"4 よくあるエラーと対処法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. よくあるエラーと対処法</h2>\n<h3 id=\"nameerror-の対処\" style=\"position:relative;\"><a href=\"#nameerror-%E3%81%AE%E5%AF%BE%E5%87%A6\" aria-label=\"nameerror の対処 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NameError の対処</h3>\n<p><code class=\"language-text\">timeit</code> モジュールでは、デフォルトでコードをグローバル名前空間内で実行します。そのため、ローカル名前空間で定義された関数や変数を認識できず、<code class=\"language-text\">NameError</code> が発生することがあります。この仕様により、計測対象のコードはグローバルスコープにある必要があります。</p>\n<h4 id=\"エラー例\" style=\"position:relative;\"><a href=\"#%E3%82%A8%E3%83%A9%E3%83%BC%E4%BE%8B\" aria-label=\"エラー例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>エラー例</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">example_function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">import</span> timeit\n<span class=\"token comment\"># これではエラーになる</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>timeit<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token string\">'example_function()'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>上記のコードでは、<code class=\"language-text\">example_function</code> がローカル名前空間に定義されているため、<code class=\"language-text\">timeit</code> がその名前を認識できず <code class=\"language-text\">NameError</code> が発生します。</p>\n<h4 id=\"修正版\" style=\"position:relative;\"><a href=\"#%E4%BF%AE%E6%AD%A3%E7%89%88\" aria-label=\"修正版 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>修正版</h4>\n<p>この問題を解決するには、<code class=\"language-text\">globals</code> 引数を指定して、<code class=\"language-text\">timeit</code> に現在のグローバル名前空間を渡します。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">example_function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">import</span> timeit\n<span class=\"token comment\"># globals を指定して関数を認識させる</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>timeit<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token string\">'example_function()'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">globals</span><span class=\"token operator\">=</span><span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>このように、<code class=\"language-text\">globals</code> を使用することで、<code class=\"language-text\">timeit</code> がグローバルスコープ内の関数や変数を正しく認識できるようになります。</p>\n<h2 id=\"5-ガベージコレクションと-code-classlanguage-texttimeitcode\" style=\"position:relative;\"><a href=\"#5-%E3%82%AC%E3%83%99%E3%83%BC%E3%82%B8%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A8-code-classlanguage-texttimeitcode\" aria-label=\"5 ガベージコレクションと code classlanguage texttimeitcode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. ガベージコレクションと <code class=\"language-text\">timeit</code></h2>\n<p><code class=\"language-text\">timeit</code> は、デフォルトで計測中にガベージコレクションを無効化します。この挙動は計測結果にノイズを含ませないためですが、ガベージコレクションが重要な場合は有効にする必要があります。</p>\n<h4 id=\"ガベージコレクションを有効化\" style=\"position:relative;\"><a href=\"#%E3%82%AC%E3%83%99%E3%83%BC%E3%82%B8%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96\" aria-label=\"ガベージコレクションを有効化 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ガベージコレクションを有効化</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> timeit\n\ngc_enabled_code <span class=\"token operator\">=</span> <span class=\"token string\">'for i in range(100): oct(i)'</span>\nsetup_code <span class=\"token operator\">=</span> <span class=\"token string\">'import gc; gc.enable()'</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>timeit<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span>gc_enabled_code<span class=\"token punctuation\">,</span> setup<span class=\"token operator\">=</span>setup_code<span class=\"token punctuation\">,</span> number<span class=\"token operator\">=</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"6-実用例コードの最適化\" style=\"position:relative;\"><a href=\"#6-%E5%AE%9F%E7%94%A8%E4%BE%8B%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E6%9C%80%E9%81%A9%E5%8C%96\" aria-label=\"6 実用例コードの最適化 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 実用例：コードの最適化</h2>\n<p><code class=\"language-text\">timeit</code> を使用すると、異なるコード実装のパフォーマンスを比較できます。</p>\n<h4 id=\"リスト内包表記-vs-for-ループ\" style=\"position:relative;\"><a href=\"#%E3%83%AA%E3%82%B9%E3%83%88%E5%86%85%E5%8C%85%E8%A1%A8%E8%A8%98-vs-for-%E3%83%AB%E3%83%BC%E3%83%97\" aria-label=\"リスト内包表記 vs for ループ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>リスト内包表記 vs. for ループ</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">list_comp <span class=\"token operator\">=</span> <span class=\"token string\">'[i**2 for i in range(1000)]'</span>\nfor_loop <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">'''\nresult = []\nfor i in range(1000):\n    result.append(i**2)\n'''</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"List Comprehension:\"</span><span class=\"token punctuation\">,</span> timeit<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span>list_comp<span class=\"token punctuation\">,</span> number<span class=\"token operator\">=</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"For Loop:\"</span><span class=\"token punctuation\">,</span> timeit<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span>for_loop<span class=\"token punctuation\">,</span> number<span class=\"token operator\">=</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"結論\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"結論 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>結論</h2>\n<p><code class=\"language-text\">timeit</code> モジュールは、Python プログラムのパフォーマンスを向上させるために非常に役立つツールです。コードの実行時間を正確に測定することで、効率的なアルゴリズムや実装方法を見つけることができます。ぜひ、日常のコーディングやプロジェクトで活用してみてください！</p>","frontmatter":{"title":"Pythonでコード実行時間を計測する - timeit","date":"2025-02-08","description":"Pythonの標準ライブラリtimeitを使用してコードの実行時間を正確に測定し、ボトルネックを特定する方法を詳しく解説。コマンドラインとスクリプトでの使い方を網羅し、実用的な例も豊富に紹介します。","tags":["Python","timeit"],"featuredImage":{"publicURL":"/static/58806ff8f67ddf870a8d9902f47dcd61/python2.jpg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/58806ff8f67ddf870a8d9902f47dcd61/3c367/python2.jpg","srcSet":"/static/58806ff8f67ddf870a8d9902f47dcd61/19e71/python2.jpg 128w,\n/static/58806ff8f67ddf870a8d9902f47dcd61/68974/python2.jpg 256w,\n/static/58806ff8f67ddf870a8d9902f47dcd61/3c367/python2.jpg 512w","sizes":"(min-width: 512px) 512px, 100vw"},"sources":[{"srcSet":"/static/58806ff8f67ddf870a8d9902f47dcd61/6766a/python2.webp 128w,\n/static/58806ff8f67ddf870a8d9902f47dcd61/22bfc/python2.webp 256w,\n/static/58806ff8f67ddf870a8d9902f47dcd61/d689f/python2.webp 512w","type":"image/webp","sizes":"(min-width: 512px) 512px, 100vw"}]},"width":512,"height":512}}}}},"relatedPosts":{"nodes":[]},"previous":{"fields":{"slug":"/python-base64/"},"frontmatter":{"title":"Pythonでデータをエンコード・デコードする - base64"}},"next":{"fields":{"slug":"/python-copy/"},"frontmatter":{"title":"Pythonでオブジェクトをコピーする: 参照、Sallow/Deep Copy - copyモジュール"}}},"pageContext":{"id":"b2e2e472-1dab-5538-9922-d0e80d1969a7","previousPostId":"099be038-e7f2-52d6-9faa-f8469f84e5a5","nextPostId":"9c908ad8-c2d2-5c03-9758-a5eb4b5f2f67","relatedPosts":[]}},"staticQueryHashes":["2841359383"],"slicesMap":{}}