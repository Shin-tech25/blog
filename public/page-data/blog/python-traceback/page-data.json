{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/python-traceback/","result":{"data":{"site":{"siteMetadata":{"title":"Developer's blog"}},"markdownRemark":{"id":"53a0b042-96de-5b92-a6c6-16aaf2aee156","excerpt":"概要  モジュールは、Python…","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E6%A6%82%E8%A6%81\">概要</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%AE%E5%87%BA%E5%8A%9B\">スタックトレースの出力</a></p>\n<ul>\n<li><a href=\"#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E4%BD%BF%E7%94%A8%E4%BE%8B---code-classlanguage-textprint_exccode\">基本的な使用例 - <code class=\"language-text\">print_exc()</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E6%96%87%E5%AD%97%E5%88%97%E3%81%A8%E3%81%97%E3%81%A6%E5%8F%96%E5%BE%97---code-classlanguage-textformat_exccode\">スタックトレースを文字列として取得 - <code class=\"language-text\">format_exc()</code></a></p>\n<ul>\n<li><a href=\"#%E4%BD%BF%E7%94%A8%E4%BE%8B\">使用例</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%88%E3%81%8F%E3%81%82%E3%82%8B%E4%BD%BF%E7%94%A8%E4%BE%8B\">よくある使用例</a></p>\n<ul>\n<li><a href=\"#%E3%82%A8%E3%83%A9%E3%83%BC%E7%99%BA%E7%94%9F%E6%99%82%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%B0%E6%94%AF%E6%8F%B4\">エラー発生時のデバッグ支援</a></li>\n<li><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E5%88%B6%E9%99%90%E3%81%97%E3%81%A6%E5%87%BA%E5%8A%9B\">スタックトレースを制限して出力</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E6%B3%A8%E6%84%8F%E7%82%B9%E3%81%A8%E3%81%BE%E3%81%A8%E3%82%81\">注意点とまとめ</a></p>\n</li>\n</ul>","html":"<h2 id=\"概要\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81\" aria-label=\"概要 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h2>\n<p><code class=\"language-text\">traceback</code> モジュールは、Python の例外発生時に生成されるスタックトレースを制御するための便利なツールです。スタックトレースは、エラー発生箇所やその原因を特定するための有益な情報を提供します。このモジュールを使うことで、エラー情報を整理し、カスタマイズして出力したりログに記録したりすることが可能です。</p>\n<p>本記事では、<code class=\"language-text\">traceback</code> モジュールの主要な関数やその使い方を具体例とともに解説します。</p>\n<h2 id=\"スタックトレースの出力\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%AE%E5%87%BA%E5%8A%9B\" aria-label=\"スタックトレースの出力 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スタックトレースの出力</h2>\n<p>例外が発生した際に、スタックトレースを出力するには <code class=\"language-text\">traceback.print_exc()</code> を使用します。この関数は、標準エラー出力やファイルに整形済みのスタックトレースを出力します。</p>\n<h3 id=\"基本的な使用例---code-classlanguage-textprint_exccode\" style=\"position:relative;\"><a href=\"#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E4%BD%BF%E7%94%A8%E4%BE%8B---code-classlanguage-textprint_exccode\" aria-label=\"基本的な使用例   code classlanguage textprint_exccode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>基本的な使用例 - <code class=\"language-text\">print_exc()</code></h3>\n<p>以下の例では、例外が発生した際にスタックトレースをコンソールに出力します。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> traceback\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">generate_error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token builtin\">tuple</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 存在しない要素へのアクセスで IndexError を発生</span>\n\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    generate_error<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> IndexError<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--- Exception occurred ---\"</span><span class=\"token punctuation\">)</span>\n    traceback<span class=\"token punctuation\">.</span>print_exc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>実行結果は以下のようになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">--- Exception occurred ---\nTraceback (most recent call last):\n  File \"example.py\", line 7, in &lt;module>\n    generate_error()\n  File \"example.py\", line 4, in generate_error\n    tuple()[0]\nIndexError: tuple index out of range</code></pre></div>\n<h2 id=\"スタックトレースを文字列として取得---code-classlanguage-textformat_exccode\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E6%96%87%E5%AD%97%E5%88%97%E3%81%A8%E3%81%97%E3%81%A6%E5%8F%96%E5%BE%97---code-classlanguage-textformat_exccode\" aria-label=\"スタックトレースを文字列として取得   code classlanguage textformat_exccode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スタックトレースを文字列として取得 - <code class=\"language-text\">format_exc()</code></h2>\n<p>スタックトレースを文字列として取得するには <code class=\"language-text\">traceback.format_exc()</code> を使用します。この方法は、スタックトレースをログファイルに記録する際などに便利です。</p>\n<h3 id=\"使用例\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8%E4%BE%8B\" aria-label=\"使用例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用例</h3>\n<p>以下のコードでは、スタックトレースをログに出力します。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> traceback\n<span class=\"token keyword\">import</span> logging\n\n<span class=\"token comment\"># ログファイルを設定</span>\nlogging<span class=\"token punctuation\">.</span>basicConfig<span class=\"token punctuation\">(</span>filename<span class=\"token operator\">=</span><span class=\"token string\">'error.log'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">format</span><span class=\"token operator\">=</span><span class=\"token string\">'%(asctime)s %(message)s'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token builtin\">tuple</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 存在しない要素へのアクセスでエラーを発生</span>\n<span class=\"token keyword\">except</span> IndexError<span class=\"token punctuation\">:</span>\n    logging<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">(</span>traceback<span class=\"token punctuation\">.</span>format_exc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>このコードを実行すると、スタックトレースが <code class=\"language-text\">error.log</code> ファイルに記録されます。</p>\n<h2 id=\"よくある使用例\" style=\"position:relative;\"><a href=\"#%E3%82%88%E3%81%8F%E3%81%82%E3%82%8B%E4%BD%BF%E7%94%A8%E4%BE%8B\" aria-label=\"よくある使用例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>よくある使用例</h2>\n<h3 id=\"エラー発生時のデバッグ支援\" style=\"position:relative;\"><a href=\"#%E3%82%A8%E3%83%A9%E3%83%BC%E7%99%BA%E7%94%9F%E6%99%82%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%B0%E6%94%AF%E6%8F%B4\" aria-label=\"エラー発生時のデバッグ支援 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>エラー発生時のデバッグ支援</h3>\n<p><code class=\"language-text\">traceback</code> モジュールは、開発中にエラーの原因を追跡するのに非常に役立ちます。特に、複雑なスクリプトや長時間実行されるバッチ処理では、スタックトレースを整理して記録することでデバッグ作業が効率化されます。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># エラーが発生する可能性のあるコード</span>\n    some_function<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n    logging<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">(</span><span class=\"token string\">\"An error occurred: %s\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span>\n    logging<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">(</span>traceback<span class=\"token punctuation\">.</span>format_exc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"スタックトレースを制限して出力\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E5%88%B6%E9%99%90%E3%81%97%E3%81%A6%E5%87%BA%E5%8A%9B\" aria-label=\"スタックトレースを制限して出力 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スタックトレースを制限して出力</h3>\n<p><code class=\"language-text\">limit</code> 引数を使用すると、出力されるスタックトレースの深さを制御できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">traceback<span class=\"token punctuation\">.</span>print_exc<span class=\"token punctuation\">(</span>limit<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>このように指定すると、最新のトレース 1 件のみが出力されます。</p>\n<h2 id=\"注意点とまとめ\" style=\"position:relative;\"><a href=\"#%E6%B3%A8%E6%84%8F%E7%82%B9%E3%81%A8%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"注意点とまとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>注意点とまとめ</h2>\n<p><code class=\"language-text\">traceback</code> モジュールは、エラーの原因を迅速に特定し、適切に処理するための強力なツールです。ただし、例外をキャッチした後に適切な処理を行わないと、プログラムの動作が不安定になる可能性があります。適切な例外処理と組み合わせて利用することで、エラー対応がより効果的になります。</p>\n<p><code class=\"language-text\">traceback</code> を活用して、エラー処理の効率を高めましょう。</p>","frontmatter":{"title":"Pythonでスタックトレースを扱う - traceback","date":"2025-02-16","description":"Pythonの例外発生時に有用なスタックトレースを制御するtracebackモジュールについて、基本的な使用方法やログ出力の例を交えながら解説します。","tags":["Python","traceback"],"featuredImage":{"publicURL":"/static/50e80906fa6b29e906668ee85d1e09f4/traceback.png","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#181818","images":{"fallback":{"src":"/static/50e80906fa6b29e906668ee85d1e09f4/ccc41/traceback.png","srcSet":"/static/50e80906fa6b29e906668ee85d1e09f4/bf8e1/traceback.png 128w,\n/static/50e80906fa6b29e906668ee85d1e09f4/acb7c/traceback.png 256w,\n/static/50e80906fa6b29e906668ee85d1e09f4/ccc41/traceback.png 512w","sizes":"(min-width: 512px) 512px, 100vw"},"sources":[{"srcSet":"/static/50e80906fa6b29e906668ee85d1e09f4/6766a/traceback.webp 128w,\n/static/50e80906fa6b29e906668ee85d1e09f4/22bfc/traceback.webp 256w,\n/static/50e80906fa6b29e906668ee85d1e09f4/d689f/traceback.webp 512w","type":"image/webp","sizes":"(min-width: 512px) 512px, 100vw"}]},"width":512,"height":512}}}}},"relatedPosts":{"nodes":[]},"previous":{"fields":{"slug":"/python-cryptgraphy2/"},"frontmatter":{"title":"Pythonによる公開鍵暗号化方式 - cryptography"}},"next":{"fields":{"slug":"/python-urllib-request/"},"frontmatter":{"title":"PythonでHTTPリクエストを送る - urllib.request"}}},"pageContext":{"id":"53a0b042-96de-5b92-a6c6-16aaf2aee156","previousPostId":"34c7cf0d-03af-5a30-bfc8-ce4632a8ca17","nextPostId":"2551b0ba-fb6d-586d-9294-cc22c460cbc1","relatedPosts":[]}},"staticQueryHashes":["2841359383"],"slicesMap":{}}